
<div class="filter-tabs m-0" [ngClass]="{ 'dark-mode': themeMode === 'dark' }"
>
  <button mat-button (click)="changeFilter('All')" [class.active]="selectedFilter === 'All'">All</button>
  <button mat-button (click)="changeFilter('Pending')" [class.active]="selectedFilter === 'Pending'">Pending</button>
  <button mat-button (click)="changeFilter('Accepted')" [class.active]="selectedFilter === 'Accepted'">Accepted</button>
  <button mat-button (click)="changeFilter('Refused')" [class.active]="selectedFilter === 'Refused'">Refused</button>

</div>
<div class="invitations-grid m-0 p-0" *ngIf="filteredInvitations.length; else noData" [ngClass]="{ 'dark-mode': themeMode === 'dark' }">
  <p *ngIf="!currentUser" class="notice">Please log in as a guest to view and respond to your invitations.</p>
  <mat-card *ngFor="let inv of filteredInvitations" class="invitation-card "
            [class.accepted]="inv.status === 'Accepted'"
            [class.refused]="inv.status === 'Refused'"
            [attr.data-ribbon]="inv.status === 'Accepted' ? 'ACCEPTED' : (inv.status === 'Refused' ? 'REFUSED' : '')">
    <img [src]="inv.eventDetails?.image || 'assets/default-event.jpg'" alt="{{ inv.eventDetails?.name }}">
    <mat-card-header>
      <mat-card-title>{{ inv.eventDetails?.name }}</mat-card-title>
      <mat-card-subtitle>{{ inv.eventDetails?.category }}</mat-card-subtitle>
    </mat-card-header>

    <mat-card-content>
      <p><strong>Location:</strong> {{ inv.eventDetails?.location }}</p>
      <p><strong>Start:</strong> {{ inv.eventDetails?.startDate | date: 'medium' }}</p>
      <p><strong>End:</strong> {{ inv.eventDetails?.endDate | date: 'medium' }}</p>
    </mat-card-content>

    <mat-card-actions *ngIf="canAct(inv); else statusChip">
      <button mat-flat-button color="accent" (click)="acceptInvitation(inv)" [disabled]="inv.status !== 'Pending'">Accept</button>
      <button mat-flat-button color="warn" (click)="refuseInvitation(inv)" [disabled]="inv.status !== 'Pending'">Refuse</button>
    </mat-card-actions>

    <ng-template #statusChip>
      <span class="status-chip" [class.accepted]="inv.status === 'Accepted'" [class.refused]="inv.status === 'Refused'">
        {{ inv.status }}
      </span>
    </ng-template>
  </mat-card>
</div>

<ng-template #noData>
  <p class="no-data">No invitations found.</p>
</ng-template>


